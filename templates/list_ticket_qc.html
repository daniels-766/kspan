<!DOCTYPE html>
<html lang="en">

<head>
    <base href="../">
    <title>Ticket {{ nomor_ticket.nomor_ticket }}</title>
    <meta name="description" content="Dashboard CS Uatas" />
    <meta name="keywords" content="Dashboard CS Uatas" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:title"
        content="Metronic - Bootstrap 5 HTML, VueJS, React, Angular &amp; Laravel Admin Dashboard Theme" />
    <meta property="og:url" content="https://keenthemes.com/metronic" />
    <meta property="og:site_name" content="Keenthemes | Metronic" />
    <link rel="canonical" href="https://preview.keenthemes.com/metronic8" />
    <link rel="shortcut icon" href="../static/assets/logo/ksp.png" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />
    <link href="../static/assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" type="text/css" />
    <link href="../static/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
    <link href="../static/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
</head>

<body id="kt_body"
    class="header-fixed header-tablet-and-mobile-fixed toolbar-enabled toolbar-fixed aside-enabled aside-fixed"
    style="--kt-toolbar-height:55px;--kt-toolbar-height-tablet-and-mobile:55px">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="alert-container position-fixed top-0 end-0 p-3" style="z-index: 9999;">
        {% for category, message in messages %}
        <div class="alert 
                {% if category == 'error' %}alert-danger
                {% elif category == 'success' %}alert-success
                {% else %}alert-info
                {% endif %}
                alert-dismissible fade show shadow-sm" role="alert" id="flash-alert-{{ loop.index }}">
            <strong>
                {% if category == 'success' %}Success!{% elif category == 'error' %}Error!{% else %}Notice!{% endif %}
            </strong> {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}
    <div class="d-flex flex-column flex-root">
        <div class="page d-flex flex-row flex-column-fluid">
            <div id="kt_aside" class="aside aside-dark aside-hoverable" data-kt-drawer="true"
                data-kt-drawer-name="aside" data-kt-drawer-activate="{default: true, lg: false}"
                data-kt-drawer-overlay="true" data-kt-drawer-width="{default:'200px', '300px': '250px'}"
                data-kt-drawer-direction="start" data-kt-drawer-toggle="#kt_aside_mobile_toggle">
                <div class="aside-logo flex-column-auto" id="kt_aside_logo">
                    <span href="">
						<img alt="Logo" src="../static/assets/logo/logos2.png" class="h-40px logo" />
					</span>
                    <div id="kt_aside_toggle" class="btn btn-icon w-auto px-0 btn-active-color-primary aside-toggle"
                        data-kt-toggle="true" data-kt-toggle-state="active" data-kt-toggle-target="body"
                        data-kt-toggle-name="aside-minimize">
                        <span class="svg-icon svg-icon-1 rotate-180">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                fill="none">
                                <path opacity="0.5"
                                    d="M14.2657 11.4343L18.45 7.25C18.8642 6.83579 18.8642 6.16421 18.45 5.75C18.0358 5.33579 17.3642 5.33579 16.95 5.75L11.4071 11.2929C11.0166 11.6834 11.0166 12.3166 11.4071 12.7071L16.95 18.25C17.3642 18.6642 18.0358 18.6642 18.45 18.25C18.8642 17.8358 18.8642 17.1642 18.45 16.75L14.2657 12.5657C13.9533 12.2533 13.9533 11.7467 14.2657 11.4343Z"
                                    fill="black" />
                                <path
                                    d="M8.2657 11.4343L12.45 7.25C12.8642 6.83579 12.8642 6.16421 12.45 5.75C12.0358 5.33579 11.3642 5.33579 10.95 5.75L5.40712 11.2929C5.01659 11.6834 5.01659 12.3166 5.40712 12.7071L10.95 18.25C11.3642 18.6642 12.0358 18.6642 12.45 18.25C12.8642 17.8358 12.8642 17.1642 12.45 16.75L8.2657 12.5657C7.95328 12.2533 7.95328 11.7467 8.2657 11.4343Z"
                                    fill="black" />
                            </svg>
                        </span>
                    </div>
                </div>
                <div class="aside-menu flex-column-fluid">
                    <div class="hover-scroll-overlay-y my-5 my-lg-5" id="kt_aside_menu_wrapper" data-kt-scroll="true"
                        data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-height="auto"
                        data-kt-scroll-dependencies="#kt_aside_logo, #kt_aside_footer"
                        data-kt-scroll-wrappers="#kt_aside_menu" data-kt-scroll-offset="0">
                        <div class="menu menu-column menu-title-gray-800 menu-state-title-primary menu-state-icon-primary menu-state-bullet-primary menu-arrow-gray-500"
							id="#kt_aside_menu" data-kt-menu="true">
							<div class="menu-item">
								<div class="menu-content pb-2">
									<span class="menu-section text-muted text-uppercase fs-8 ls-1">Dashboard</span>
								</div>
							</div>
							<div class="menu-item">
								<a class="menu-link" href="{{ url_for('qc_dashboard') }}">
									<span class="menu-icon">
										<span class="svg-icon svg-icon-2">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path
													d="M20 19.725V18.725C20 18.125 19.6 17.725 19 17.725H5C4.4 17.725 4 18.125 4 18.725V19.725H3C2.4 19.725 2 20.125 2 20.725V21.725H22V20.725C22 20.125 21.6 19.725 21 19.725H20Z"
													fill="currentColor" />
												<path opacity="0.3"
													d="M22 6.725V7.725C22 8.325 21.6 8.725 21 8.725H18C18.6 8.725 19 9.125 19 9.725C19 10.325 18.6 10.725 18 10.725V15.725C18.6 15.725 19 16.125 19 16.725V17.725H15V16.725C15 16.125 15.4 15.725 16 15.725V10.725C15.4 10.725 15 10.325 15 9.725C15 9.125 15.4 8.725 16 8.725H13C13.6 8.725 14 9.125 14 9.725C14 10.325 13.6 10.725 13 10.725V15.725C13.6 15.725 14 16.125 14 16.725V17.725H10V16.725C10 16.125 10.4 15.725 11 15.725V10.725C10.4 10.725 10 10.325 10 9.725C10 9.125 10.4 8.725 11 8.725H8C8.6 8.725 9 9.125 9 9.725C9 10.325 8.6 10.725 8 10.725V15.725C8.6 15.725 9 16.125 9 16.725V17.725H5V16.725C5 16.125 5.4 15.725 6 15.725V10.725C5.4 10.725 5 10.325 5 9.725C5 9.125 5.4 8.725 6 8.725H3C2.4 8.725 2 8.325 2 7.725V6.725L11 2.225C11.6 1.925 12.4 1.925 13.1 2.225L22 6.725ZM12 3.725C11.2 3.725 10.5 4.425 10.5 5.225C10.5 6.025 11.2 6.725 12 6.725C12.8 6.725 13.5 6.025 13.5 5.225C13.5 4.425 12.8 3.725 12 3.725Z"
													fill="currentColor" />
											</svg>
										</span>
									</span>
									<span class="menu-title">Dashboard</span>
								</a>
							</div>
                            <div class="menu-item">
								<a class="menu-link" href="{{ url_for('case_valid_qc') }}">
									<span class="menu-icon">
										<span class="svg-icon svg-icon-2">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path opacity="0.3" d="M10 4H21C21.6 4 22 4.4 22 5V7H10V4Z"
													fill="currentColor" />
												<path opacity="0.3"
													d="M10.3 15.3L11 14.6L8.70002 12.3C8.30002 11.9 7.7 11.9 7.3 12.3C6.9 12.7 6.9 13.3 7.3 13.7L10.3 16.7C9.9 16.3 9.9 15.7 10.3 15.3Z"
													fill="currentColor" />
												<path
													d="M10.4 3.60001L12 6H21C21.6 6 22 6.4 22 7V19C22 19.6 21.6 20 21 20H3C2.4 20 2 19.6 2 19V4C2 3.4 2.4 3 3 3H9.20001C9.70001 3 10.2 3.20001 10.4 3.60001ZM11.7 16.7L16.7 11.7C17.1 11.3 17.1 10.7 16.7 10.3C16.3 9.89999 15.7 9.89999 15.3 10.3L11 14.6L8.70001 12.3C8.30001 11.9 7.69999 11.9 7.29999 12.3C6.89999 12.7 6.89999 13.3 7.29999 13.7L10.3 16.7C10.5 16.9 10.8 17 11 17C11.2 17 11.5 16.9 11.7 16.7Z"
													fill="currentColor" />
											</svg>
										</span>
									</span>
									<span class="menu-title">Case Valid</span>
								</a>
							</div>
                            <div class="menu-item">
								<a class="menu-link" href="{{ url_for('case_not_valid_qc') }}">
									<span class="menu-icon">
										<span class="svg-icon svg-icon-2">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path opacity="0.3" d="M10 4H21C21.6 4 22 4.4 22 5V7H10V4Z"
													fill="currentColor" />
												<path opacity="0.3"
													d="M12 14.4L9.89999 16.5C9.69999 16.7 9.39999 16.8 9.19999 16.8C8.99999 16.8 8.7 16.7 8.5 16.5C8.1 16.1 8.1 15.5 8.5 15.1L10.6 13L12 14.4ZM13.4 13L15.5 10.9C15.9 10.5 15.9 9.90001 15.5 9.50001C15.1 9.10001 14.5 9.10001 14.1 9.50001L12 11.6L13.4 13Z"
													fill="currentColor" />
												<path
													d="M10.4 3.60001L12 6H21C21.6 6 22 6.4 22 7V19C22 19.6 21.6 20 21 20H3C2.4 20 2 19.6 2 19V4C2 3.4 2.4 3 3 3H9.2C9.7 3 10.2 3.20001 10.4 3.60001ZM13.4 13L15.5 10.9C15.9 10.5 15.9 9.9 15.5 9.5C15.1 9.1 14.5 9.1 14.1 9.5L12 11.6L9.89999 9.5C9.49999 9.1 8.9 9.1 8.5 9.5C8.1 9.9 8.1 10.5 8.5 10.9L10.6 13L8.5 15.1C8.1 15.5 8.1 16.1 8.5 16.5C8.7 16.7 9 16.8 9.2 16.8C9.4 16.8 9.69999 16.7 9.89999 16.5L12 14.4L14.1 16.5C14.3 16.7 14.6 16.8 14.8 16.8C15 16.8 15.3 16.7 15.5 16.5C15.9 16.1 15.9 15.5 15.5 15.1L13.4 13Z"
													fill="currentColor" />
											</svg>
										</span>
									</span>
									<span class="menu-title">Case Tidak Valid</span>
								</a>
							</div>
                            <div class="menu-item">
								<a class="menu-link" href="{{ url_for('case_reopen_qc') }}">
									<span class="menu-icon">
										<span class="svg-icon svg-icon-2">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path opacity="0.3" d="M10 4H21C21.6 4 22 4.4 22 5V7H10V4Z" fill="currentColor"/>
                                                <path d="M10.4 3.60001L12 6H21C21.6 6 22 6.4 22 7V19C22 19.6 21.6 20 21 20H3C2.4 20 2 19.6 2 19V4C2 3.4 2.4 3 3 3H9.20001C9.70001 3 10.2 3.20001 10.4 3.60001ZM12 16.8C11 16.8 10.2 16.4 9.5 15.8C8.8 15.1 8.5 14.3 8.5 13.3C8.5 12.8 8.59999 12.3 8.79999 11.9L10 13.1V10.1C10 9.50001 9.6 9.10001 9 9.10001H6L7.29999 10.4C6.79999 11.3 6.5 12.2 6.5 13.3C6.5 14.8 7.10001 16.2 8.10001 17.2C9.10001 18.2 10.5 18.8 12 18.8C12.6 18.8 13 18.3 13 17.8C13 17.2 12.6 16.8 12 16.8ZM16.7 16.2C17.2 15.3 17.5 14.4 17.5 13.3C17.5 11.8 16.9 10.4 15.9 9.39999C14.9 8.39999 13.5 7.79999 12 7.79999C11.4 7.79999 11 8.19999 11 8.79999C11 9.39999 11.4 9.79999 12 9.79999C12.9 9.79999 13.8 10.2 14.5 10.8C15.2 11.5 15.5 12.3 15.5 13.3C15.5 13.8 15.4 14.3 15.2 14.7L14 13.5V16.5C14 17.1 14.4 17.5 15 17.5H18L16.7 16.2Z" fill="currentColor"/>
                                                <path opacity="0.3" d="M12 16.8C11 16.8 10.2 16.4 9.5 15.8C8.8 15.1 8.5 14.3 8.5 13.3C8.5 12.8 8.59999 12.3 8.79999 11.9L7.29999 10.4C6.79999 11.3 6.5 12.2 6.5 13.3C6.5 14.8 7.10001 16.2 8.10001 17.2C9.10001 18.2 10.5 18.8 12 18.8C12.6 18.8 13 18.3 13 17.8C13 17.2 12.6 16.8 12 16.8Z" fill="currentColor"/>
                                                <path opacity="0.3" d="M15.5 13.3C15.5 13.8 15.4 14.3 15.2 14.7L16.7 16.2C17.2 15.3 17.5 14.4 17.5 13.3C17.5 11.8 16.9 10.4 15.9 9.39999C14.9 8.39999 13.5 7.79999 12 7.79999C11.4 7.79999 11 8.19999 11 8.79999C11 9.39999 11.4 9.79999 12 9.79999C12.9 9.79999 13.8 10.2 14.5 10.8C15.1 11.5 15.5 12.4 15.5 13.3Z" fill="currentColor"/>
											</svg>
										</span>
									</span>
									<span class="menu-title">Case Re-Open</span>
								</a>
							</div>
						</div>
                    </div>
                </div>
                
            </div>
            <div class="wrapper d-flex flex-column flex-row-fluid" id="kt_wrapper">
                <div id="kt_header" class="header align-items-stretch">
                    <div class="container-fluid d-flex align-items-stretch justify-content-between">
                        <div class="d-flex align-items-center d-lg-none ms-n3 me-1" title="Show aside menu">
                            <div class="btn btn-icon btn-active-light-primary w-30px h-30px w-md-40px h-md-40px"
                                id="kt_aside_mobile_toggle">
                                <span class="svg-icon svg-icon-2x mt-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none">
                                        <path
                                            d="M21 7H3C2.4 7 2 6.6 2 6V4C2 3.4 2.4 3 3 3H21C21.6 3 22 3.4 22 4V6C22 6.6 21.6 7 21 7Z"
                                            fill="black" />
                                        <path opacity="0.3"
                                            d="M21 14H3C2.4 14 2 13.6 2 13V11C2 10.4 2.4 10 3 10H21C21.6 10 22 10.4 22 11V13C22 13.6 21.6 14 21 14ZM22 20V18C22 17.4 21.6 17 21 17H3C2.4 17 2 17.4 2 18V20C2 20.6 2.4 21 3 21H21C21.6 21 22 20.6 22 20Z"
                                            fill="black" />
                                    </svg>
                                </span>
                            </div>
                        </div>
                        <div class="d-flex align-items-center flex-grow-1 flex-lg-grow-0">
                            <a href="../../demo1/dist/index.html" class="d-lg-none">
                                <img alt="Logo" src="../static/assets/media/logos/logo-2.svg" class="h-30px" />
                            </a>
                        </div>
                        <div class="d-flex align-items-stretch justify-content-between flex-lg-grow-1">
                            <div class="d-flex align-items-stretch" id="kt_header_nav">
                                <div class="header-menu align-items-stretch" data-kt-drawer="true"
                                    data-kt-drawer-name="header-menu"
                                    data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true"
                                    data-kt-drawer-width="{default:'200px', '300px': '250px'}"
                                    data-kt-drawer-direction="end" data-kt-drawer-toggle="#kt_header_menu_mobile_toggle"
                                    data-kt-swapper="true" data-kt-swapper-mode="prepend"
                                    data-kt-swapper-parent="{default: '#kt_body', lg: '#kt_header_nav'}">
                                    <div class="menu menu-lg-rounded menu-column menu-lg-row menu-state-bg menu-title-gray-700 menu-state-title-primary menu-state-icon-primary menu-state-bullet-primary menu-arrow-gray-400 fw-bold my-5 my-lg-0 align-items-stretch"
                                        id="#kt_header_menu" data-kt-menu="true">
                                        <div class="menu-item me-lg-1">
                                            <a class="menu-link py-3" href="{{ url_for('qc_dashboard') }}">
                                                <span class="menu-title">Dashboard</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex align-items-stretch flex-shrink-0">
                                <div class="d-flex align-items-stretch flex-shrink-0">
                                    <div class="d-flex align-items-center ms-1 ms-lg-3">
									</div>
                                    <div class="d-flex align-items-center ms-1 ms-lg-3" id="kt_header_user_menu_toggle">
                                        <div class="cursor-pointer symbol symbol-30px symbol-md-40px"
                                            data-kt-menu-trigger="click" data-kt-menu-attach="parent"
                                            data-kt-menu-placement="bottom-end">
                                            <img src="../static/assets/logo/ksp.png"
                                                alt="user" />
                                        </div>
                                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-primary fw-bold py-4 fs-6 w-275px"
                                            data-kt-menu="true">
                                            <div class="menu-item px-3">
                                                <div class="menu-content d-flex align-items-center px-3">
                                                    <div class="symbol symbol-50px me-5">
                                                        <img alt="Logo"
                                                            src="../static/assets/logo/ksp.png" />
                                                    </div>
                                                    <div class="d-flex flex-column">
                                                        <div class="fw-bolder d-flex align-items-center fs-5">{{
                                                            user.username }}
                                                            <span
                                                                class="badge badge-light-success fw-bolder fs-8 px-2 py-1 ms-2">{{
                                                                user.role }}</span>
                                                        </div>
                                                        <span class="fw-bold text-muted text-hover-primary fs-7">{{
                                                            user.email }}</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="menu-item px-5">
                                                <a href="{{ url_for('logout') }}" class="menu-link px-5">Sign Out</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center d-lg-none ms-2 me-n3"
                                        title="Show header menu">
                                        <div class="btn btn-icon btn-active-light-primary w-30px h-30px w-md-40px h-md-40px"
                                            id="kt_header_menu_mobile_toggle">
                                            <span class="svg-icon svg-icon-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none">
                                                    <path
                                                        d="M13 11H3C2.4 11 2 10.6 2 10V9C2 8.4 2.4 8 3 8H13C13.6 8 14 8.4 14 9V10C14 10.6 13.6 11 13 11ZM22 5V4C22 3.4 21.6 3 21 3H3C2.4 3 2 3.4 2 4V5C2 5.6 2.4 6 3 6H21C21.6 6 22 5.6 22 5Z"
                                                        fill="black" />
                                                    <path opacity="0.3"
                                                        d="M21 16H3C2.4 16 2 15.6 2 15V14C2 13.4 2.4 13 3 13H21C21.6 13 22 13.4 22 14V15C22 15.6 21.6 16 21 16ZM14 20V19C14 18.4 13.6 18 13 18H3C2.4 18 2 18.4 2 19V20C2 20.6 2.4 21 3 21H13C13.6 21 14 20.6 14 20Z"
                                                        fill="black" />
                                                </svg>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                    <div class="toolbar" id="kt_toolbar">
                        <div id="kt_toolbar_container" class="container-fluid d-flex flex-stack">
                            <div data-kt-swapper="true" data-kt-swapper-mode="prepend"
                                data-kt-swapper-parent="{default: '#kt_content_container', 'lg': '#kt_toolbar_container'}"
                                class="page-title d-flex align-items-center flex-wrap me-3 mb-5 mb-lg-0">
                                <h1 class="d-flex align-items-center text-dark fw-bolder fs-3 my-1">Nomor Ticket : {{
                                    nomor_ticket.nomor_ticket }}
                                </h1>
                            </div>
                        </div>
                    </div>
                    <div class="post d-flex flex-column-fluid" id="kt_post">
                        <div id="kt_content_container" class="container-xxl">
                            <div class="card mb-5 mb-xl-10">
                                <div class="card-body pt-9 pb-0">
                                    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
                                        <div class="d-flex overflow-auto h-55px">
                                            <ul class="nav nav-tabs" id="ticketTabs" role="tablist">
                                                {% for ticket in tickets %}
                                                <li class="nav-item" role="presentation">
                                                    <button class="nav-link {% if loop.first %}active{% endif %}"
                                                        id="ticket-tab-{{ loop.index }}" data-bs-toggle="tab"
                                                        data-bs-target="#ticket-{{ loop.index }}" type="button"
                                                        role="tab" aria-controls="ticket-{{ loop.index }}"
                                                        aria-selected="{{ 'true' if loop.first else 'false' }}">
                                                        Order #{{ loop.index }}
                                                    </button>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card mb-5 mb-xl-10" id="kt_profile_details_view">
                                <div
                                    class="card-header cursor-pointer d-flex justify-content-between align-items-center">
                                    <div class="card-title m-0">
                                        <h3 class="fw-bolder m-0">Informasi Kontak Konsumen</h3>
                                    </div>
                                    <div class="d-flex gap-2">
                                        <a href="{{ url_for('qc_dashboard') }}" class="btn btn-primary">Kembali</a>
                                        <a href="#" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#kt_modal_view_catatan_nomor_ticket">Catatan</a>
                                    </div>
                                </div>
                                <div class="modal fade" id="kt_modal_view_catatan_nomor_ticket" tabindex="-1" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered mw-650px">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h2 class="fw-bolder">Catatan  {{ nomor_ticket.nomor_ticket }}</h2>
                                            </div>
                                            <div class="modal-body py-10 px-lg-17">
                                                <div class="scroll-y me-n7 pe-7" data-kt-scroll-offset="300px" style="max-height: 400px; overflow-y: auto;">
                                                    {% if catatan_list %}
                                                        {% for c in catatan_list %}
                                                        <div class="border p-4 rounded mb-4 bg-light">
                                                            <div class="mb-2">
                                                            <strong>Tanggal : </strong> {{ c.tanggal.strftime('%d-%m-%Y %H:%M') if c.tanggal else '-' }}
                                                            </div>
                                                            <div class="mb-2">
                                                            <strong>Uploaded by : </strong> {{ c.user.username if c.user else '-' }}
                                                            </div>
                                                            <div class="mb-2">
                                                            <strong>Deskripsi:</strong>
                                                            <div class="text-muted mt-1">{{ c.deskripsi or '-' }}</div>
                                                            </div>
                                                        </div>
                                                        {% endfor %}
                                                    {% else %}
                                                        <p class="text-muted">Belum ada catatan untuk ticket ini.</p>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body p-9">
                                    <div class="tab-content" id="ticketTabContent">
                                        {% for ticket in tickets %}
                                        {% set kontak = ticket.kontaks[0] if ticket.kontaks else None %}
                                        <div class="tab-pane fade {% if loop.first %}show active{% endif %}"
                                            id="ticket-{{ loop.index }}" role="tabpanel"
                                            aria-labelledby="ticket-tab-{{ loop.index }}">
                                            
                                            <div class="modal fade" id="kt_modal_add_catatan_{{ loop.index }}" tabindex="-1" aria-hidden="true">
                                                <div class="modal-dialog modal-dialog-centered mw-650px">
                                                    <div class="modal-content">
                                                        <form method="POST" action="{{ url_for('update_catatan', ticket_id=ticket.id) }}">
                                                            <div class="modal-header" id="kt_modal_add_catatab_header">
                                                                <h2 class="fw-bolder">Detail Catatan Follow Up Pengaduan Nasabah</h2>
                                                            </div>
                                                            <div class="modal-body py-10 px-lg-17">
                                                                <div class="scroll-y me-n7 pe-7" data-kt-scroll-offset="300px">
                                                                    <div class="row g-9 mb-7">
                                                                        <div class="col-md-12 fv-row">
                                                                            <label class="fs-6 fw-bold mb-2">Catatan</label>
                                                                            <textarea name="catatan" rows="5" class="form-control form-control-solid" disabled>{{ ticket.catatan or '' }}</textarea>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row g-9 mb-7">
                                                                        <div class="col-md-12 fv-row">
                                                                            <label class="fs-6 fw-bold mb-2">Tanggal Catatan : </label>
                                                                            <span class="fw-bold fs-6 text-gray-800 text-hover-primary bold"> {{ ticket.tanggal_catatan or '-' }} </span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card mb-5 mb-xl-10" id="kt_profile_details_view">
                                                <div
                                                    class="card-header cursor-pointer d-flex justify-content-between align-items-center">
                                                    <div class="card-title m-0">
                                                        <h3 class="fw-bolder m-0">
                                                            Status Case :
                                                            {% if nomor_ticket.label_case == 'valid' %}
                                                                <span class="badge badge-success">{{ nomor_ticket.label_case|capitalize }}</span>
                                                            {% elif nomor_ticket.label_case == 'tidak valid' %}
                                                                <span class="badge badge-danger">{{ nomor_ticket.label_case|capitalize }}</span>
                                                            {% elif nomor_ticket.label_case == 'reopen' %}
                                                                <span class="badge badge-info">{{ nomor_ticket.label_case|capitalize }}</span>
                                                            {% else %}
                                                                <span class="badge badge-info">Belum Ditentukan</span>
                                                            {% endif %}
                                                        </h3>
                                                    </div>
                                                </div>
                                                <div class="card-body p-9">
                                                    <form method="POST" action="{{ url_for('update_tahapan', nomor_ticket_id=nomor_ticket.id, ticket_id=ticket.id) }}"data-ticket-id="{{ ticket.id }}">
                                                        <!-- <div class="row">
                                                            <div class="col-md-6">
                                                            </div>
                                                            <div class="col-md-6 text-end">
                                                                <a href="#" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#kt_modal_add_catatan_{{ loop.index }}">Catatan</a>
                                                            </div>
                                                        </div> -->
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">Nama Lengkap</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.nama_nasabah or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">NIK</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.nik or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-4">
                                                                    <label class="col-lg-5 fw-bold text-muted">No HP <span class="badge badge-success">Utama</span></label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.nomor_utama or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-4">
                                                                    <label class="col-lg-5 fw-bold text-muted">No HP Kontak <span class="badge badge-primary">Kontak</span></label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.nomor_kontak or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-4">
                                                                    <label class="col-lg-5 fw-bold text-muted">Email</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.email or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">Bucket</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.nama_bucket or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label
                                                                        class="col-lg-5 fw-bold text-muted">Tahapan</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.tahapan or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">Kanal Pengaduan</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold fs-6 text-gray-800 text-hover-primary"> {{ ticket.kanal_pengaduan or '-' }}
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">Nomor Tiket</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold fs-6 text-gray-800 text-hover-primary"> {{ ticket.nomor_ticket.nomor_ticket }}
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">Jenis Pengaduan</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6"> {{ jenis_pengaduan_map.get(ticket.jenis_pengaduan | int, 'Tidak Diketahui') }}
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">Nomor Order</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.order_no or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">Nama Dc</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.nama_dc or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">OS</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.nama_os or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted">SLA</label>
                                                                    <div class="col-lg-7">
                                                                        <span class="fw-bold text-gray-800 fs-6"><span class="badge badge-danger">{{ ticket.sla or '-' }}</span></span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-7">
                                                                <div class="row mb-7">
                                                                    <label class="col-lg-5 fw-bold text-muted mb-4">Deksripsi</label>
                                                                    <div class="col-lg-12">
                                                                        <span class="fw-bold text-gray-800 fs-6">{{ ticket.deskripsi_pengaduan or '-' }}</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    <hr style="height: 3px; size: 20;">
                                                    <div class="row">
                                                        {% if ticket.document %}
                                                        <div class="col-md-6 ">
                                                            <label class="form-label fw-bold text-muted">Dokumen Terlampir Dari Team CS :</label>
                                                            <div class="border rounded p-3 bg-light">
                                                                {% for file in ticket.document.split(',') %}
                                                                <div class="d-flex justify-content-between align-items-center mb-2 bg-white p-2 rounded shadow-sm">
                                                                    <div>
                                                                        <i class="fas fa-file-alt text-primary me-2"></i>
                                                                        <a href="{{ url_for('static', filename='uploads/' ~ file) }}" target="_blank">{{ file }}</a>
                                                                    </div>
                                                                </div>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card mb-5 mb-xl-10">
                                                <div class="card-header d-flex justify-content-between align-items-center cursor-pointer"
                                                     data-bs-target="#collapse_kuasa_konsumen"
                                                    aria-expanded="false" aria-controls="collapse_kuasa_konsumen"
                                                    id="kuasaKonsumenHeader">
                                                    <h3 class="fw-bolder m-0">Follow Up QC</h3>
                                                </div>
                                                <div id="collapse_kuasa_konsumen">
                                                    {% set kontak = ticket.kontaks[0] if ticket.kontaks else None %}
                                                    <form class="form" method="POST" action="{{ url_for('add_detail_qc', ticket_id=ticket.id) }}" enctype="multipart/form-data">
                                                        <div class="card-body border-top p-9">
                                                            <div class="row mb-6">
                                                                <label class="col-lg-4 col-form-label fw-bold fs-6 text-muted">Deksripsi QC</label>
                                                                <div class="col-lg-8 fv-row">
                                                                    <textarea name="deskripsi_qc"
                                                                        class="form-control form-control-lg form-control-solid"
                                                                        rows="5" required>{{ ticket.deskripsi_qc or '' }}</textarea>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-6">
                                                                <label class="col-lg-4 col-form-label fw-bold fs-6 text-muted">Status</label>
                                                                <div class="col-lg-8 fv-row">
                                                                    <select name="status_case" aria-label="Select a Timezone" data-control="select2"
                                                                            data-placeholder="Select status.." class="form-select form-select-solid form-select-lg" required>
                                                                        <option value="">Select status</option>
                                                                        <option value="valid" {% if ticket.nomor_ticket and ticket.nomor_ticket.label_case == "valid" %}selected{% endif %}>Valid</option>
                                                                        <option value="tidak valid" {% if ticket.nomor_ticket and ticket.nomor_ticket.label_case == "tidak valid" %}selected{% endif %}>Tidak Valid</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div class="row mb-6">
                                                            <label class="col-lg-4 col-form-label fw-bold fs-6 text-muted">
                                                                Upload Bukti File (boleh lebih dari satu)
                                                            </label>
                                                                <div class="col-lg-8 fv-row">
                                                                    <input type="file" name="file_qc" class="form-control" multiple>
                                                                    
                                                                    {% if ticket.file_qc %}
                                                                    <div class="mt-3 d-flex flex-wrap gap-3" id="bukti-preview">
                                                                    {% set icons = {
                                                                        'pdf': 'https://img.icons8.com/?size=100&id=mcyAsTDJNTI9&format=png&color=000000',
                                                                        'doc': 'https://img.icons8.com/?size=100&id=utR42bh35xFv&format=png&color=000000',
                                                                        'docx': 'https://img.icons8.com/?size=100&id=utR42bh35xFv&format=png&color=000000',
                                                                        'xls': 'https://img.icons8.com/?size=100&id=117561&format=png&color=000000',
                                                                        'xlsx': 'https://img.icons8.com/?size=100&id=117561&format=png&color=000000',
                                                                        'txt': 'https://img.icons8.com/?size=100&id=zUXqp5j4wrS6&format=png&color=000000'
                                                                    } %}
                                                                    
                                                                    {% for file in ticket.file_qc.split(',') %}
                                                                    {% set ext = file.split('.')[-1]|lower %}
                                                                    <div class="position-relative text-center" style="width: 120px;">
                                                                        {% if ext in ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'] %}
                                                                        <img src="{{ url_for('static', filename='uploads/' ~ file) }}"
                                                                            class="img-thumbnail" style="width: 100%; height: auto;">
                                                                        {% else %}
                                                                        <img src="{{ icons.get(ext, 'https://img.icons8.com/ios/100/000000/file--v1.png') }}"
                                                                            class="img-thumbnail" style="width: 100%; height: auto;">
                                                                        {% endif %}
                                                                        
                                                                        <small class="d-block mt-1 text-truncate" title="{{ file }}">{{ file }}</small>
                                                                        
                                                                        <a class="btn btn-sm btn-primary mt-1"
                                                                        href="{{ url_for('static', filename='uploads/' ~ file) }}"
                                                                        download>
                                                                        Download
                                                                        </a>
                                                                        
                                                                        <button type="button"
                                                                                class="btn btn-sm btn-danger position-absolute top-0 end-0"
                                                                                onclick="removeImage(this, '{{ file }}')">x</button>
                                                                        
                                                                        <input type="hidden" name="existing_images" value="{{ file }}">
                                                                    </div>
                                                                    {% endfor %}
                                                                    </div>
                                                                    {% endif %}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="card-footer d-flex justify-content-end py-6 px-9">
                                                            <button type="reset"
                                                                class="btn btn-light btn-active-light-primary me-2">Discard</button>
                                                            <button type="submit" class="btn btn-primary">Save
                                                                Changes</button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer py-4 d-flex flex-lg-column" id="kt_footer">
                    <div
                        class="container-fluid d-flex flex-column flex-md-row align-items-center justify-content-between">
                        <div class="text-dark order-2 order-md-1">
                            <span class="text-muted fw-bold me-1">2025</span>
                            <a href="https://ksparthaniaga.com/" target="_blank"
                                class="text-gray-800 text-hover-primary">KSP Artha Niaga</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="kt_scrolltop" class="scrolltop" data-kt-scrolltop="true">
        <span class="svg-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                <rect opacity="0.5" x="13" y="6" width="13" height="2" rx="1" transform="rotate(90 13 6)"
                    fill="black" />
                <path
                    d="M12.5657 8.56569L16.75 12.75C17.1642 13.1642 17.8358 13.1642 18.25 12.75C18.6642 12.3358 18.6642 11.6642 18.25 11.25L12.7071 5.70711C12.3166 5.31658 11.6834 5.31658 11.2929 5.70711L5.75 11.25C5.33579 11.6642 5.33579 12.3358 5.75 12.75C6.16421 13.1642 6.83579 13.1642 7.25 12.75L11.4343 8.56569C11.7467 8.25327 12.2533 8.25327 12.5657 8.56569Z"
                    fill="black" />
            </svg>
        </span>
    </div>
    <script>var hostUrl = "../static/assets/";</script>
    <script src="../static/assets/plugins/global/plugins.bundle.js"></script>
    <script src="../static/assets/js/scripts.bundle.js"></script>
    <script src="../static/assets/js/custom/widgets.js"></script>
    <script src="../static/assets/js/custom/apps/chat/chat.js"></script>
    <script src="../static/assets/js/custom/modals/create-app.js"></script>
    <script src="../static/assets/js/custom/modals/upgrade-plan.js"></script>
    <script>
        document.querySelectorAll('.status-select').forEach(select => {
            select.addEventListener('change', function () {
                const ticketId = this.dataset.ticketId;
                const status = this.value;
                const keberatanFields = document.getElementById(`keberatan_fields_${ticketId}`);
                const tutupFields = document.getElementById(`tutup_fields_${ticketId}`);

                if (status === '3') {
                    keberatanFields.classList.remove('d-none');
                    tutupFields.classList.add('d-none');
                } else if (status === '4') {
                    tutupFields.classList.remove('d-none');
                    keberatanFields.classList.add('d-none');
                } else {
                    keberatanFields.classList.add('d-none');
                    tutupFields.classList.add('d-none');
                }
            });
        });
    </script>
    <script>
        setTimeout(function () {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(function (alert) {
                alert.classList.remove('show');
                alert.classList.add('fade');
                setTimeout(() => alert.remove(), 500);
            });
        }, 2000); 
    </script>
    <script>
        const headerKuasa = document.getElementById('kuasaKonsumenHeader');
        const iconKuasa = document.getElementById('iconKuasaKonsumen');
        const collapseKuasa = document.getElementById('collapse_kuasa_konsumen');

        collapseKuasa.addEventListener('show.bs.collapse', function () {
            iconKuasa.classList.remove('fa-chevron-down');
            iconKuasa.classList.add('fa-chevron-up');
        });

        collapseKuasa.addEventListener('hide.bs.collapse', function () {
            iconKuasa.classList.remove('fa-chevron-up');
            iconKuasa.classList.add('fa-chevron-down');
        });
    </script>
    <script>
        function previewImages() {
            const previewContainer = document.getElementById('preview-container');
            const input = document.getElementById('bukti_chat');
            previewContainer.innerHTML = "";

            if (input.files) {
                Array.from(input.files).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const img = document.createElement("img");
                        img.src = e.target.result;
                        img.classList.add("img-thumbnail");
                        img.style.width = "100px";
                        img.style.height = "100px";
                        previewContainer.appendChild(img);
                    };
                    reader.readAsDataURL(file);
                });
            }
        }
    </script>
    <script>
        const detailMap = {{ detail_pengaduan_map | tojson }};
        const jenisSelect = document.querySelector("select[name='jenis_pengaduan']");
        const detailSelect = document.querySelector("select[name='detail_pengaduan']");

        jenisSelect.addEventListener("change", function () {
            const selected = parseInt(this.value);
            const details = detailMap[selected] || [];
            detailSelect.innerHTML = "";
            details.forEach(function (d) {
                const opt = document.createElement("option");
                opt.value = d;
                opt.innerText = d;
                detailSelect.appendChild(opt);
            });
        });
    </script>
    <script>
        function removeImage(button, filename) {
            const imageDiv = button.parentElement;
            imageDiv.remove();

            const input = document.createElement("input");
            input.type = "hidden";
            input.name = "deleted_images";
            input.value = filename;
            document.querySelector("form").appendChild(input);
        }
    </script>
    <script>
document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('select[name="tahapan"]').forEach(function (dropdown) {
    const ticketId = dropdown.closest('form').dataset.ticketId;
    const qcDropdown = document.getElementById('qc_user_dropdown_' + ticketId);

    function toggleQcField() {
      if (dropdown.value === 'Eskalasi ke QC') {
        qcDropdown.classList.remove('d-none');
      } else {
        qcDropdown.classList.add('d-none');
      }
    }

    dropdown.addEventListener('change', toggleQcField);
    toggleQcField(); // initialize on load
  });
});
</script>

</body>

</html>